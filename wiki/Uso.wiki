#labels wiki,seguridad,linux,checklist
= Uso del script =

Uso: checklist-linux.pl opciones

- La ejecucion del script corre esto bajo su propia responsabilidad y en un ambiente controlado.

opciones? Analisis que vamos a ejecutar

    --usuariodefault Analizamos que los usuarios default del SO. no estan creados 

    --permisosAD Analizamos los permisos de los archivos/directorios criticos 

    --suidguidsticky Analizamos permisos especiales en todo el sistema 

    --sinownergroup Buscamos en el sistema archivos/directorios sin owner 

    --writeparatodos Buscamos en el sistema archivos/directorios con escritura 

    --syslog Verificamos que este configurado un syslog externo 

    --usuariosgrupos Asociamos los usuarios del sistema a sus respectivos grupos 

    --expiracionUsuarios Verificamos las variables de expiracion de las cuentas de usuarios 

    --seguridadnet Verificamos las variables de expiracion de las cuentas de usuarios 

    --seguridadssh Verificamos las variables del servicio sshd 

    --todos Ejecutamos todos los analisis 


== --usuariodefault ==
situ@tux ~/ $ perl checklist-linux.pl --usuariodefault
-----------------------------------------------------------------------------------
Sistema Operativo: Linux

Release del Kernel: 2.6.31-21-generic

Hostname: tux

Datos Adicionales: Linux tux 2.6.31-21-generic #59-Ubuntu SMP Wed Mar 24 07:28:56 UTC 2010 i686 GNU/Linux
-----------------------------------------------------------------------------------
 -- Verificacion de usuarios default
-----------------------------------------------------------------------------------
Negativo: El usuario lp existe

Negativo: El usuario uucp existe

Negativo: El usuario games existe


== --permisosAD ==
situ@tux ~/ $ perl checklist-linux.pl --permisosAD
-----------------------------------------------------------------------------------
Sistema Operativo: Linux

Release del Kernel: 2.6.31-21-generic

Hostname: tux

Datos Adicionales: Linux tux 2.6.31-21-generic #59-Ubuntu SMP Wed Mar 24 07:28:56 UTC 2010 i686 GNU/Linux
-----------------------------------------------------------------------------------
 -- Verificar permisos en archivos y directorios
-----------------------------------------------------------------------------------
Negativo: El archivo /bin/ tiene como permiso 0755

Negativo: El archivo /boot/ tiene como permiso 0755

Negativo: El archivo /etc/ tiene como permiso 0755

Negativo: El archivo /etc/cron.daily/ tiene como permiso 0755

Negativo: El archivo /etc/cron.hourly/ tiene como permiso 0755

Negativo: El archivo /etc/cron.weekly/ tiene como permiso 0755

No existe El archivo /etc/exports no existe en el sistema o no puede ser accedido

No existe El archivo /etc/inittab no existe en el sistema o no puede ser accedido

Negativo: El archivo /etc/motd tiene como permiso 0666

No existe El archivo /etc/syslog.conf no existe en el sistema o no puede ser accedido

Negativo: El archivo /home/ tiene como permiso 0755

Negativo: El archivo /lib/ tiene como permiso 0755

Negativo: El archivo /mnt/ tiene como permiso 0755

No leible El archivo /root/ no puede ser leido

Negativo: El archivo /root/ tiene como permiso 0700

Negativo: El archivo /sbin/ tiene como permiso 0755

Negativo: El archivo /tmp/ tiene como permiso 1777

Negativo: El archivo /usr/ tiene como permiso 0755

Negativo: El archivo /usr/bin/ tiene como permiso 0755

Negativo: El archivo /var/ tiene como permiso 0755
-----------------------------------------------------------------------------------



== --suidguidsticky ==
situ@tux ~/ $ perl checklist-linux.pl --suidguidsticky
-----------------------------------------------------------------------------------
Sistema Operativo: Linux

Release del Kernel: 2.6.31-21-generic

Hostname: tux

Datos Adicionales: Linux tux 2.6.31-21-generic #59-Ubuntu SMP Wed Mar 24 07:28:56 UTC 2010 i686 GNU/Linux
-----------------------------------------------------------------------------------
 -- Verificacion de Suid Bit / Guid Bit / Sticky Bit
-----------------------------------------------------------------------------------
Informacion: Se detecto suid/gsid en /srv/cvs

Informacion: Se detecto suid/gsid en /srv/cvs/CVSROOT

Informacion: Se detecto suid/gsid en /srv/cvs/CVSROOT/Emptydir

Informacion: Se detecto suid/gsid en /bin/ping6

Informacion: Se detecto suid/gsid en /bin/umount

Informacion: Se detecto suid/gsid en /bin/su

Informacion: Se detecto suid/gsid en /bin/mount

Informacion: Se detecto suid/gsid en /bin/ping

Informacion: Se detecto suid/gsid en /bin/fusermount

Informacion: Se detecto sticky bit en /var/spool/samba

Informacion: Se detecto sticky bit en /var/spool/cups/tmp

Informacion: Se detecto sticky bit en /var/spool/cups-pdf/ANONYMOUS

Informacion: Se detecto sticky bit en /var/spool/cron/atspool

Informacion: Se detecto sticky bit en /var/spool/cron/crontabs

Informacion: Se detecto sticky bit en /var/spool/cron/atjobs

Informacion: Se detecto sticky bit en /var/spool/postfix/maildrop

Informacion: Se detecto suid/gsid en /var/spool/postfix/public

Informacion: Se detecto sticky bit en /var/crash

Informacion: Se detecto sticky bit en /var/log/gdm

Informacion: Se detecto suid/gsid en /var/log/exim4

Informacion: Se detecto suid/gsid en /var/log/nagios3

Informacion: Se detecto suid/gsid en /var/log/nagios3/archives

Informacion: Se detecto suid/gsid en /var/log/mysql